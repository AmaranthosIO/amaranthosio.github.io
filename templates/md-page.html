{% extends "base.html" %}
{% import "macros/image.html" as image %}
{% block title %}{{page.title}} | {{config.title}}{% endblock %}
{% block banner %}
<div class="w-100">
  <img src="{{get_url(path=config.extra.banner)}}" class="w-100" />
</div>
{% endblock %}
{% block content %}
  <h1>{{page.title}}</h1>
  {% if page.taxonomies.tags %}
  <p>
    {% for tag in page.taxonomies.tags %}
      <a
        href="{{get_taxonomy_url(kind="tags", name=tag)}}"
        class="badge bg-dark text-decoration-none link-light me-1"
      >
        {{tag}}
      </a>
    {% endfor %}
  </p>
  {% endif %}

  {# master detail for chapters #}

  <div class="container-fluid">
    <div class="row">
       <div id="master" class="col-sm-4">  
        {% if page.extra.chapters %}

        {% set_global chapter_data = load_data(path=page.extra.chapters) %}

        {% if chapter_data.chapters %}
        <ul>
          {% for chapter in chapter_data.chapters %}
          <li>
            <div>
              <div class="row">
                <div class="col-md-2">
                  {{ image::render(src=chapter.image, alt=chapter.title) }}
                </div>
                <div class="col-fluid offset-md-2">
                  <h3>{{chapter.title}}</h3>
                </div>
              </div>
            </div>
            <dl>
              <dt>{{chapter.name | safe}}</dt>
              <dd><h3>{{chapter.description | safe}}</h3>
              {% if chapter.links %}
                <dl>
                  {% for link in chapter.links %}
                  <dt><a href="{{link.url | safe}}" target="detail-frame">{{link.name | safe}}</a></dt>
                  <dd>{{link.description | safe}}</dd>
                  {% endfor %}
                </dl>
              {% endif %}        
            </dd>
          </li>
          {% endfor %}
        </ul>
        {% else %}
          <h4>No Chapters Found</h4>
        {% endif %}
        {% endif %}
      </div>
      <div id="detail" class="col-xxl offset-sm-4">
        <iframe name="detail-frame" href="{{get_url(path=chapter_data.chapters[0].links[0].url)}}"></iframe>
      </div>
    </div>
 </div>
{% endblock %}

{% block scripts %}
{% endblock %}
